<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>W-ê³¡ì„  ìœ ë§ì£¼ ëŒ€ì‹œë³´ë“œ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        /* [ë‹¤í¬ ëª¨ë“œ í…Œë§ˆ ì •ì˜] - ìƒì„¸ í˜ì´ì§€ì™€ í†µì¼ */
        :root {
            --bg-color: #1e1e1e;       /* ë°°ê²½ìƒ‰: ì§„í•œ íšŒìƒ‰ */
            --card-bg: #2d2d2d;        /* ì¹´ë“œ ë°°ê²½: ë°ì€ íšŒìƒ‰ */
            --text-main: #e0e0e0;      /* ë©”ì¸ ê¸€ì: ì—°í•œ íšŒìƒ‰ */
            --text-sub: #b0b0b0;       /* ë³´ì¡° ê¸€ì: íšŒìƒ‰ */
            --accent: #bb86fc;         /* ê°•ì¡°ìƒ‰: ì—°ë³´ë¼ */
            --border: #444444;         /* í…Œë‘ë¦¬ ìƒ‰ */
            --input-bg: #383838;       /* ì…ë ¥ì°½ ë°°ê²½ */
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: 'Noto Sans KR', sans-serif;
        }

        /* ë§í¬ ìŠ¤íƒ€ì¼ ì¬ì •ì˜ */
        a { text-decoration: none; color: inherit; }
        a:hover { color: var(--accent); }

        /* ì¹´ë“œ (ë°•ìŠ¤) ìŠ¤íƒ€ì¼ ì»¤ìŠ¤í…€ */
        .card {
            background-color: var(--card-bg);
            border: 1px solid var(--border);
            color: var(--text-main);
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3); /* ê·¸ë¦¼ì ì¶”ê°€ */
        }

        /* ê²€ìƒ‰ì°½ ì»¤ìŠ¤í…€ */
        .form-control {
            background-color: var(--input-bg);
            border: 1px solid var(--border);
            color: var(--text-main);
        }
        .form-control:focus {
            background-color: var(--input-bg);
            color: white;
            border-color: var(--accent);
            box-shadow: 0 0 0 0.25rem rgba(187, 134, 252, 0.25);
        }
        .form-control::placeholder { color: #888; }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn-primary {
            background-color: #6200ea;
            border-color: #6200ea;
        }
        .btn-primary:hover {
            background-color: #3700b3;
            border-color: #3700b3;
        }
        .btn-outline-secondary {
            color: var(--text-sub);
            border-color: var(--border);
        }
        .btn-outline-secondary:hover {
            background-color: var(--border);
            color: white;
        }
        .btn-dark {
            background-color: #121212;
            border: 1px solid var(--border);
        }

        /* í…Œì´ë¸” í—¤ë” ì»¤ìŠ¤í…€ (í•„ìš” ì‹œ) */
        .table-dark-custom {
            background-color: var(--card-bg);
            color: var(--text-main);
        }

        /* ë±ƒì§€ ìŠ¤íƒ€ì¼ */
        .w-score-badge {
            font-size: 1.2rem;
            font-weight: bold;
            color: #ff4757; /* ë¶‰ì€ìƒ‰ ê°•ì¡° */
        }

        /* ì¹´ë“œ í˜¸ë²„ íš¨ê³¼ */
        .stock-card:hover {
            transform: translateY(-5px);
            transition: 0.3s;
            border-color: var(--accent);
        }
    </style>
</head>
<body>

    <div class="container py-5">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="fw-bold">
                ğŸ“ˆ W-ê³¡ì„  ìœ ë§ì£¼ í¬ì°©
                <span class="badge bg-danger rounded-pill align-middle fs-6">{{ total_count }}ê°œ</span>
            </h1>
            <a href="{% url 'stocks:stock_list' %}" class="btn btn-outline-secondary">
                ğŸ“‹ ì „ì²´ ì¢…ëª© ë³´ê¸°
            </a>
        </div>

        <form method="get" class="mb-5">
            <div class="input-group input-group-lg">
                <input type="text" name="q" class="form-control" placeholder="ì¢…ëª©ëª… ë˜ëŠ” ì½”ë“œ ê²€ìƒ‰..." value="{{ search_query }}">
                <button class="btn btn-primary" type="submit">ğŸ” ê²€ìƒ‰</button>
            </div>
        </form>

        <div class="row">
            {% load humanize %}
            {% if w_stocks %}
                {% for stock in w_stocks %}
                <div class="col-md-4 mb-4">
                    <div class="card stock-card h-100">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-start">
                                <div>
                                    <h4 class="card-title fw-bold mb-0">{{ stock.name }}</h4>
                                    <small style="color: var(--text-sub);">{{ stock.code }} | {{ stock.market }}</small>
                                </div>
                                <span class="w-score-badge">{{ stock.w_score }}ì </span>
                            </div>

                            <hr style="border-color: var(--border);">

                            <div class="d-flex justify-content-between mb-3">
                                <span style="color: var(--text-sub);">í˜„ì¬ê°€</span>
                                <strong style="font-size: 1.1em; color: var(--accent);">
                                    {{ stock.current_price|intcomma }}ì›
                                </strong>
                            </div>

                            <div class="d-flex justify-content-between mb-3">
                                <span style="color: var(--text-sub);">ë¶„ì„ì¼</span>
                                <span style="font-size: 0.9em;">{{ stock.last_analyzed|date:"Y-m-d" }}</span>
                            </div>

                            <a href="{% url 'stocks:stock_detail' stock.code %}" class="btn btn-dark w-100 mt-2">
                                âœ¨ AI ìƒì„¸ ë¶„ì„ ë° ì°¨íŠ¸ ë³´ê¸°
                            </a>
                        </div>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div class="col-12 text-center py-5">
                    <div class="card py-5">
                        <h3 class="text-muted">ì•„ì§ í¬ì°©ëœ W-ê³¡ì„  ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤. ğŸ˜¢</h3>
                        <p style="color: var(--text-sub);">ë°ì´í„° ìˆ˜ì§‘ê³¼ ë¶„ì„ ì»¤ë§¨ë“œë¥¼ ë¨¼ì € ì‹¤í–‰í•´ ì£¼ì„¸ìš”!</p>
                        <code style="background: #121212; padding: 5px 10px; border-radius: 5px; color: #ff4757;">
                            python manage.py analyze_w
                        </code>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>